<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="메뉴선택" />
<link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2929/2929270.png" />
<title>메뉴 선택</title>
<style>
  html, body {
    margin: 0; padding: 0; height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    background: #fff;
    -webkit-user-select: none; /* 터치 후 텍스트 선택 방지 */
    -webkit-tap-highlight-color: transparent;
    display: flex;
    flex-direction: column;
  }
  body {
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
    box-sizing: border-box;
    height: 100vh;
    overflow: hidden;
  }
  #selected {
    white-space: pre-line;
    font-weight: 600;
    margin-bottom: 20px;
    font-size: 1.2rem;
    color: #222;
    max-width: 480px;
    word-break: keep-all;
  }
  #menu {
    width: 100%;
    max-width: 480px;
  }
  button {
    display: block;
    width: 100%;
    max-width: 480px;
    margin: 8px auto;
    padding: 16px 0;
    font-size: 1.3rem;
    border: none;
    border-radius: 14px;
    background-color: #007aff;
    color: white;
    font-weight: 600;
    cursor: pointer;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    transition: background-color 0.2s ease;
  }
  button:active {
    background-color: #005bb5;
  }
  #backBtn {
    background-color: #ff3b30;
    margin-top: 24px;
  }
</style>
</head>
<body>

<div id="selected"></div>
<div id="menu"></div>
<button id="backBtn" style="display:none;">뒤로 가기</button>

<script>
const steps = [
  ["막국수", "닭갈비"],
  {
    "막국수": ["샘밭막국수", "유포리막국수"],
    "닭갈비": ["숯불닭갈비", "철판닭갈비"]
  },
  {
    "숯불닭갈비": ["통나무집", "토담 숯불 닭갈비"],
    "철판닭갈비": ["통나무집", "우성닭갈비"]
  },
  ["산", "강"],
  {
    "산": ["지씨아뜰리에", "카페코빈즈"],
    "강": ["카페 디 쿼드", "비엔나커피하우스", "어스17"]
  }
];

let selections = [];
let currentStep = 0;

const selectedDiv = document.getElementById("selected");
const menuDiv = document.getElementById("menu");
const backBtn = document.getElementById("backBtn");

function showMenu() {
  menuDiv.innerHTML = "";

  let options;
  if (currentStep === 0) {
    options = steps[0];
  } else if (currentStep === 1) {
    options = steps[1][selections[0]];
  } else if (currentStep === 2) {
    if (selections[0] === "막국수") {
      currentStep = 3; // 막국수는 3단계 건너뜀
      return showMenu();
    } else {
      options = steps[2][selections[1]];
    }
  } else if (currentStep === 3) {
    options = steps[3];
  } else if (currentStep === 4) {
    options = steps[4][selections[selections.length - 1]];
  } else if (currentStep === 5) {
    showFinal();
    return;
  }

  options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = () => {
      selections.push(opt);
      currentStep++;
      showMenu();
    };
    menuDiv.appendChild(btn);
  });

  backBtn.style.display = currentStep > 0 ? "block" : "none";
  updateSelected();
}

function showFinal() {
  menuDiv.innerHTML = "";

  const filtered = selections.filter(s => s !== "산" && s !== "강");
  selectedDiv.textContent = filtered.join("\n");

  backBtn.style.display = "block";
}

function updateSelected() {
  selectedDiv.textContent = selections.join(" > ");
}

backBtn.onclick = () => {
  if (currentStep > 0) {
    selections.pop();
    currentStep--;
    if (selections[0] === "막국수" && currentStep === 3) {
      currentStep = 2; // 막국수 경로에서 뒤로 가기 시 3단계 조정
    }
    showMenu();
  }
};

showMenu();
</script>

</body>
</html>
