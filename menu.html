<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>점심 메뉴 선택</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    text-align: center;
  }
  header {
    padding: 16px;
    font-size: 1.5rem;
    font-weight: bold;
    background-color: #007aff;
    color: white;
  }
  #cafeView {
    font-size: 1.2rem;
    margin: 12px 0;
    color: #555;
  }
  #selected {
    margin: 10px;
    font-weight: bold;
    white-space: pre-line;
  }
  #menu {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  button {
    display: block;
    width: 90%;
    max-width: 300px;
    margin: 10px auto;
    padding: 14px;
    font-size: 18px;
    border: none;
    border-radius: 12px;
    background-color: #f0f0f0;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
  }
  button:active {
    background-color: #ddd;
  }
  #backBtn {
    background-color: #ff3b30;
    color: white;
    font-weight: bold;
  }
</style>
</head>
<body>

<header>점심 메뉴</header>
<div id="cafeView"></div>
<div id="selected"></div>
<div id="menu"></div>
<button id="backBtn" style="display:none;">뒤로 가기</button>

<script>
const steps = [
  ["막국수", "닭갈비"],
  {
    "막국수": ["샘밭막국수", "유포리막국수"],
    "닭갈비": ["숯불닭갈비", "철판닭갈비"]
  },
  {
    "숯불닭갈비": ["통나무집", "토담 숯불 닭갈비"],
    "철판닭갈비": ["통나무집", "우성닭갈비"]
  },
  ["산", "강"],
  {
    "산": ["지씨아뜰리에", "카페코빈즈"],
    "강": ["카페 디 쿼드", "비엔나커피하우스", "어스17"]
  }
];

let selections = [];
let currentStep = 0;

function showMenu() {
  const menuDiv = document.getElementById("menu");
  const cafeViewDiv = document.getElementById("cafeView");
  cafeViewDiv.textContent = "";

  menuDiv.innerHTML = "";

  let options;
  if (currentStep === 0) {
    options = steps[0];
  } else if (currentStep === 1) {
    options = steps[1][selections[0]];
  } else if (currentStep === 2) {
    if (selections[0] === "막국수") {
      currentStep = 3; // 막국수 경로에서 3단계 건너뜀
      return showMenu();
    } else {
      options = steps[2][selections[1]];
    }
  } else if (currentStep === 3) {
    options = steps[3];
    cafeViewDiv.textContent = "카페 뷰"; // 4단계에서 카페뷰 추가
  } else if (currentStep === 4) {
    options = steps[4][selections[selections.length - 1]];
  } else if (currentStep === 5) {
    showFinal();
    return;
  }

  options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = () => {
      selections.push(opt);
      currentStep++;
      showMenu();
    };
    menuDiv.appendChild(btn);
  });

  document.getElementById("backBtn").style.display = currentStep > 0 ? "block" : "none";
  updateSelected();
}

function showFinal() {
  const menuDiv = document.getElementById("menu");
  menuDiv.innerHTML = "";

  // 산과 강 제외하고 최종 선택 표시, 줄바꿈
  const filteredSelections = selections.filter(sel => sel !== "산" && sel !== "강");
  document.getElementById("selected").textContent = filteredSelections.join("\n");
}

function updateSelected() {
  document.getElementById("selected").textContent = selections.join(" → ");
}

document.getElementById("backBtn").onclick = () => {
  if (currentStep > 0) {
    selections.pop();
    currentStep--;
    if (selections[0] === "막국수" && currentStep === 3) {
      currentStep = 2; // 막국수 경로 뒤로가기 처리
    }
    showMenu();
  }
};

showMenu();
</script>

</body>
</html>
